package main

import (
	"bytes"
	"github.com/kasperdi/SPHINCSPLUS-golang/address"
	"github.com/kasperdi/SPHINCSPLUS-golang/parameters"
	"github.com/kasperdi/SPHINCSPLUS-golang/sphincs"
	"github.com/kasperdi/SPHINCSPLUS-golang/util"
	"github.com/kasperdi/SPHINCSPLUS-golang/wots"
	"slices"
	"testing"
)

var WOTSPublicKey = []byte{65, 191, 63, 108, 246, 152, 176, 65, 253, 124, 74, 29, 245, 123, 10, 130, 96, 207, 167, 62, 249, 205, 81, 23, 163, 48, 125, 22, 14, 115, 151, 10, 201, 43, 22, 189, 198, 109, 150, 229, 148, 12, 206, 182, 32, 59, 33, 72, 115, 236, 82, 13, 157, 214, 49, 165, 33, 156, 80, 8, 191, 140, 177, 31, 123, 48, 236, 201, 123, 255, 138, 25, 81, 139, 137, 226, 140, 88, 123, 144, 242, 157, 10, 190, 86, 161, 69, 213, 32, 213, 103, 53, 172, 90, 32, 185, 10, 3, 223, 68, 203, 236, 21, 0, 128, 75, 204, 146, 232, 182, 242, 37, 49, 227, 134, 238, 223, 158, 83, 61, 103, 83, 98, 72, 22, 119, 247, 59, 227, 247, 91, 150, 219, 43, 172, 93, 252, 69, 247, 73, 191, 249, 204, 156, 96, 10, 213, 246, 188, 28, 207, 155, 165, 143, 13, 56, 118, 207, 8, 60, 223, 49, 167, 213, 226, 58, 97, 244, 15, 187, 251, 241, 9, 30, 71, 201, 17, 10, 35, 78, 104, 204, 247, 14, 77, 61, 73, 12, 131, 253, 187, 53, 57, 40, 247, 194, 59, 253, 79, 8, 246, 134, 116, 35, 130, 204, 13, 230, 35, 15, 77, 32, 121, 22, 6, 102, 169, 37, 255, 42, 94, 176, 56, 36, 206, 52, 115, 142, 182, 239, 57, 15, 218, 59, 103, 47, 186, 23, 68, 73, 55, 152, 13, 153, 171, 174, 67, 194, 52, 158, 64, 176, 223, 113, 198, 29, 149, 241, 253, 174, 51, 7, 86, 122, 74, 55, 100, 222, 46, 142, 91, 244, 247, 56, 249, 153, 179, 120, 188, 55, 78, 46, 78, 131, 198, 22, 91, 152, 241, 43, 242, 224, 138, 223, 195, 150, 143, 162, 214, 189, 20, 131, 16, 191, 169, 206, 151, 57, 163, 49, 127, 199, 156, 237, 217, 150, 230, 87, 108, 199, 125, 99, 215, 68, 106, 188, 98, 178, 15, 62, 114, 142, 49, 37, 221, 17, 175, 219, 142, 191, 223, 224, 13, 153, 205, 92, 61, 198, 61, 39, 83, 47, 218, 154, 203, 14, 132, 27, 132, 124, 44, 252, 15, 50, 151, 174, 157, 123, 107, 218, 213, 141, 185, 17, 8, 65, 73, 154, 29, 0, 15, 37, 38, 22, 217, 16, 195, 38, 110, 101, 156, 47, 15, 112, 31, 135, 17, 56, 206, 95, 96, 70, 61, 97, 252, 179, 68, 43, 189, 86, 181, 68, 17, 155, 114, 173, 13, 171, 115, 249, 14, 217, 3, 53, 5, 116, 204, 95, 104, 140, 62, 192, 149, 85, 128, 70, 176, 147, 3, 18, 207, 226, 57, 239, 231, 229, 246, 174, 231, 1, 134, 210, 168, 225, 112, 233, 221, 40, 167, 27, 213, 56, 213, 184, 178, 151, 191, 198, 108, 68, 157, 46, 187, 52, 192, 187, 225, 223, 3, 143, 137, 21, 202, 205, 230, 75, 141, 137, 129, 183, 229, 90, 86, 126, 154, 83, 230, 164, 37, 92, 176, 155, 72, 204, 123, 151, 47, 146, 145, 30, 220, 196, 37, 19, 3, 84, 39, 239, 12, 119, 20, 225, 201, 44, 238, 70, 53, 122, 237, 145, 55, 0, 190, 50, 47, 163, 232, 187, 155, 179, 2, 58, 153, 31, 41, 159, 235, 255, 41, 158, 216, 43, 124, 205, 33, 90, 243, 227, 213, 100, 166, 212, 162, 233, 151, 193, 25, 198, 131, 220, 220, 42, 194, 159, 201, 56, 116, 164, 222, 139, 150, 66, 156, 178, 110, 20, 216, 247, 211, 113, 60, 180, 38, 174, 138, 97, 11, 245, 244, 220, 67, 131, 79, 166, 109, 117, 218, 63, 209, 127, 40, 75, 140, 0, 191, 202, 14, 243, 183, 191, 215, 242, 234, 43, 42, 240, 36, 196, 233, 57, 85, 97, 91, 205, 137, 114, 55, 81, 13, 13, 21, 240, 219, 50, 43, 118, 46, 182, 90, 210, 211, 86, 125, 78, 166, 83, 215, 179, 228, 177, 172, 228, 222, 122, 137, 81, 2, 89, 253, 144, 107, 75, 145, 158, 208, 193, 126, 77, 152, 175, 114, 158, 99, 177, 77, 154, 228, 230, 67, 39, 224, 43, 125, 119, 199, 62, 33, 113, 198, 12, 172, 104, 207, 50, 25, 148, 184, 221, 158, 76, 235, 12, 158, 114, 119, 212, 156, 105, 109, 214, 98, 222, 96, 147, 87, 204, 165, 2, 181, 43, 110, 102, 201, 28, 200, 75, 163, 162, 158, 169, 96, 218, 138, 38, 173, 27, 80, 117, 169, 209, 8, 222, 83, 101, 215, 22, 76, 112, 81, 97, 182, 182, 191, 69, 208, 111, 12, 53, 79, 30, 150, 39, 197, 4, 32, 159, 109, 227, 71, 175, 41, 2, 48, 222, 163, 138, 205, 22, 163, 84, 158, 62, 52, 30, 86, 115, 75, 54, 24, 205, 33, 174, 15, 98, 243, 183, 69, 110, 233, 2, 28, 118, 109, 12, 91, 124, 72, 223, 215, 143, 214, 132, 144, 154, 173, 96, 39, 235, 24, 55, 226, 8, 63, 217, 115, 164, 40, 151, 99, 0, 14, 149, 20, 114, 236, 182, 228, 44, 184, 90, 68, 189, 205, 81, 158, 116, 150, 22, 148, 171, 244, 120, 157, 13, 121, 210, 218, 37, 82, 193, 71, 59, 85, 115, 144, 164, 225, 209, 62, 246, 93, 170, 40, 139, 167, 44, 101, 32, 119, 226, 233, 26, 158, 55, 90, 254, 232, 102, 190, 122, 159, 167, 235, 155, 207, 18, 129, 24, 85, 219, 32, 200, 200, 183, 53, 171, 70, 61, 148, 235, 178, 23, 0, 164, 233, 79, 23, 182, 189, 41, 101, 146, 178, 141, 16, 24, 121, 98, 71, 37, 41, 10, 99, 51, 32, 112, 204, 243, 159, 241, 197, 166, 166, 60, 187, 35, 89, 242, 7, 237, 248, 72, 19, 10, 149, 237, 158, 85, 245, 108, 157, 7, 67, 99, 54, 245, 113, 9, 255, 143, 17, 54, 143, 202, 166, 203, 238, 174, 119, 5, 69, 242, 210, 95, 146, 137, 208, 236, 150, 98, 18, 80, 43, 250, 47, 92, 221, 29, 102, 218, 93, 41, 162, 227, 194, 251, 0, 34, 211, 133, 4, 234, 116, 208, 13, 217, 44, 53, 172, 87, 97, 108, 150, 247, 251, 74, 100, 33, 122, 222, 162, 31, 48, 72, 46, 138, 96, 50, 238, 211, 178, 128, 13, 155, 228, 225, 191, 214, 8, 109, 179, 134, 228, 60, 234, 87, 72, 122, 247, 173, 181, 248, 215, 7, 19, 143, 161, 108, 230, 153, 188, 137, 49, 5, 200, 114, 50, 180, 4, 5, 226, 205, 215, 7, 21, 160, 59, 121, 162, 102, 58, 177, 169, 242, 111, 13, 108, 191, 177, 71, 222, 211, 233, 57, 175, 149, 91, 10, 44, 200, 7, 40, 92, 178, 203, 175, 101, 125, 164, 105, 150, 7, 127, 198, 119, 178, 133, 40, 144, 185, 212, 76, 77, 17, 33, 59, 102, 225, 250, 162, 188, 194, 22, 157, 192, 108, 50, 56, 15, 33, 15, 28, 65, 14, 237, 115, 113, 184, 10, 143, 11, 89, 231, 134, 143, 131, 86, 65, 2, 49, 54, 203, 222, 130, 32, 181, 13, 39, 128, 58, 149, 214, 113, 13, 150, 153, 133, 19, 215, 183, 234, 222, 38, 43, 237, 187, 223, 38, 90, 122, 237, 61, 29, 185, 119, 207, 86, 107, 10, 180, 174, 33, 23, 198, 18, 139, 204, 151, 11, 186, 65, 30, 242, 141, 64, 203, 148, 226, 196, 12, 245, 88, 129, 129, 173, 179, 67, 129, 21, 207, 175, 129, 114, 177, 180, 90, 214, 246, 105, 165, 20, 37, 194, 135, 212, 127, 237, 17, 198, 126, 242, 40, 205, 255, 73, 116, 32, 15, 127, 19, 181, 247, 177, 99, 80, 111, 46, 24, 13, 87, 9, 106, 227, 38, 48, 85, 223, 220, 35, 249, 65, 24, 104, 239, 253, 179, 106, 28, 211, 173, 118, 232, 235, 255, 119, 56, 251, 119, 119, 63, 238, 54, 232, 172, 33, 187, 52, 156, 69, 185, 132, 224, 14, 60, 154, 168, 190, 113, 210, 252, 14, 240, 238, 242, 204, 176, 74, 36, 7, 73, 33, 210, 118, 218, 127, 136, 33, 53, 238, 112, 88, 125, 202, 185, 207, 32, 121, 53, 100, 30, 99, 208, 135, 61, 1, 165, 116, 35, 53, 159, 112, 201, 203, 52, 130, 113, 110, 91, 129, 247, 123, 192, 136, 31, 82, 158, 51, 15, 17, 140, 193, 79, 243, 192, 107, 62, 226, 232, 75, 57, 49, 230, 210, 14, 241, 116, 189, 10, 54, 222, 65, 214, 217, 20, 108, 46, 187, 110, 176, 229, 101, 241, 95, 164, 119, 113, 254, 236, 230, 247, 130, 199, 224, 5, 234, 25, 99, 88, 141, 184, 155, 46, 39, 177, 221, 218, 29, 240, 110, 231, 85, 73, 83, 94, 32, 2, 206, 168, 237, 249, 221, 145, 117, 234, 247, 195, 224, 99, 163, 239, 25, 4, 112, 160, 206, 84, 100, 245, 92, 172, 234, 35, 119, 48, 205, 118, 247, 227, 180, 10, 120, 4, 17, 220, 118, 160, 11, 150, 158, 152, 24, 227, 120, 248, 11, 187, 103, 65, 220, 197, 230, 234, 78, 2, 76, 115, 178, 197, 203, 190, 34, 61, 130, 233, 62, 22, 11, 100, 212, 32, 53, 109, 28, 70, 133, 120, 13, 213, 159, 42, 15, 158, 135, 118, 70, 234, 179, 224, 183, 119, 235, 255, 247, 108, 35, 220, 104, 71, 5, 8, 190, 97, 55, 227, 240, 48, 218, 93, 7, 91, 129, 21, 78, 88, 123, 220, 179, 27, 121, 49, 29, 30, 61, 143, 153, 221, 220, 143, 16, 200, 135, 92, 44, 199, 208, 231, 130, 33, 153, 182, 228, 20, 150, 121, 248, 117, 61, 223, 63, 162, 101, 117, 128, 44, 138, 11, 170, 150, 111, 254, 71, 240, 162, 233, 109, 11, 202, 74, 135, 185, 147, 30, 254, 153, 29, 217, 104, 25, 118, 2, 117, 162, 34, 21, 2, 15, 50, 79, 52, 84, 98, 223, 236, 67, 134, 78, 51, 255, 109, 103, 103, 211, 167, 5, 229, 131, 74, 124, 192, 56, 230, 35, 138, 149, 136, 53, 159, 117, 101, 111, 193, 110, 226, 22, 218, 171, 70, 133, 122, 118, 182, 82, 206, 122, 60, 160, 202, 149, 168, 104, 91, 41, 121, 120, 224, 27, 181, 119, 229, 20, 8, 240, 59, 129, 196, 79, 20, 55, 174, 38, 11, 211, 85, 9, 191, 1, 115, 163, 209, 155, 253, 253, 233, 230, 49, 2, 187, 80, 180, 146, 252, 231, 51, 234, 175, 107, 245, 112, 225, 187, 37, 132, 16, 20, 248, 195, 190, 245, 177, 137, 97, 168, 95, 97, 149, 210, 184, 161, 193, 195, 32, 226, 249, 62, 181, 135, 223, 128, 230, 0, 126, 37, 163, 77, 189, 217, 164, 130, 72, 193, 52, 238, 121, 197, 62, 252, 70, 220, 107, 115, 174, 70, 191, 96, 180, 133, 15, 156, 69, 114, 233, 79, 231, 108, 128, 72, 111, 156, 6, 116, 132, 66, 105, 218, 37, 116, 131, 188, 55, 127, 25, 113, 64, 80, 46, 34, 157, 109, 245, 200, 113, 238, 90, 6, 75, 197, 19, 133, 232, 113, 9, 169, 65, 184, 106, 70, 186, 154, 68, 51, 216, 49, 53, 81, 71, 38, 193, 29, 69, 156, 97, 233, 22, 144, 138, 251, 174, 118, 115, 203, 232, 64, 24, 21, 19, 66, 18, 226, 168, 234, 208, 145, 97, 30, 69, 247, 160, 229, 24, 201, 3, 142, 217, 136, 140, 89, 57, 77, 55, 113, 137, 8, 15, 217, 203, 70, 243, 36, 56, 42, 196, 204, 32, 124, 58, 242, 132, 129, 173, 60, 132, 201, 58, 42, 158, 179, 74, 98, 255, 145, 99, 112, 216, 136, 205, 62, 129, 162, 216, 85, 49, 52, 186, 12, 235, 187, 34, 86, 157, 105, 12, 106, 222, 160, 17, 133, 116, 159, 226, 202, 123, 88, 244, 64, 180, 145, 14, 62, 196, 201, 25, 238, 152, 44, 73, 141, 76, 187, 171, 65, 139, 130, 181, 72, 172, 199, 135, 49, 181, 8, 81, 199, 124, 31, 161, 125, 74, 127, 88, 112, 129, 133, 24, 61, 65, 18, 156, 55, 202, 63, 105, 82, 91, 57, 204, 121, 253, 102, 20, 69, 205, 107, 171, 141, 228, 166, 97, 51, 172, 99, 31, 231, 171, 83, 20, 131, 211, 150, 253, 229, 9, 135, 70, 114, 236, 239, 50, 161, 117, 119, 179, 214, 83, 243, 211, 83, 102, 0, 147, 154, 236, 206, 98, 43, 209, 162, 10, 239, 192, 117, 158, 100, 142, 218, 236, 235, 29, 221, 148, 38, 41, 147, 206, 133, 250, 171, 38, 177, 246, 175, 171, 57, 66, 205, 25, 115, 195, 239, 237, 11, 246, 86, 90, 171, 18, 91, 115, 195, 167, 54, 243, 8, 36, 169, 165, 215, 48, 205, 253, 105, 1, 148, 36, 28}

// from valid sig
var WOTSTestSig = []byte{189, 206, 199, 52, 189, 207, 29, 33, 227, 219, 137, 120, 191, 167, 82, 147, 164, 45, 10, 27, 212, 217, 92, 125, 240, 204, 87, 19, 89, 16, 141, 99, 24, 93, 207, 233, 77, 179, 152, 164, 125, 163, 37, 177, 182, 135, 105, 99, 96, 171, 67, 239, 36, 54, 191, 114, 130, 9, 37, 188, 113, 38, 126, 82, 212, 68, 128, 159, 30, 81, 155, 109, 221, 241, 181, 190, 106, 158, 189, 146, 41, 100, 76, 246, 167, 252, 164, 46, 49, 220, 41, 46, 94, 28, 126, 250, 179, 155, 36, 247, 226, 54, 234, 185, 2, 244, 34, 58, 111, 136, 72, 232, 79, 127, 101, 160, 234, 42, 17, 18, 173, 78, 7, 168, 234, 82, 71, 51, 57, 165, 96, 198, 70, 185, 14, 109, 103, 65, 51, 106, 110, 179, 235, 178, 178, 170, 90, 104, 129, 23, 150, 47, 126, 58, 72, 117, 72, 33, 163, 69, 102, 24, 75, 250, 111, 85, 116, 66, 196, 124, 177, 156, 13, 90, 214, 113, 110, 152, 143, 192, 205, 247, 255, 119, 12, 213, 254, 133, 103, 27, 69, 10, 150, 166, 102, 244, 216, 192, 16, 8, 114, 152, 84, 207, 60, 96, 248, 158, 91, 69, 204, 228, 126, 227, 94, 3, 30, 232, 214, 195, 91, 62, 145, 253, 102, 111, 115, 20, 190, 16, 216, 162, 96, 215, 90, 40, 216, 55, 49, 160, 46, 235, 3, 158, 2, 133, 25, 38, 39, 190, 148, 93, 22, 201, 86, 105, 6, 126, 118, 39, 65, 193, 228, 247, 13, 224, 26, 199, 214, 151, 118, 65, 50, 126, 140, 253, 5, 67, 105, 231, 177, 19, 14, 170, 67, 193, 238, 208, 205, 120, 136, 108, 226, 233, 18, 162, 234, 171, 201, 42, 113, 22, 131, 65, 200, 22, 203, 84, 36, 1, 118, 225, 161, 180, 131, 55, 235, 243, 30, 190, 14, 111, 213, 223, 117, 130, 167, 175, 14, 169, 183, 143, 105, 47, 157, 172, 115, 128, 233, 59, 168, 221, 58, 34, 226, 106, 161, 226, 141, 105, 119, 168, 218, 154, 203, 14, 132, 27, 132, 124, 44, 252, 15, 50, 151, 174, 157, 123, 107, 218, 213, 141, 185, 17, 8, 65, 73, 154, 29, 0, 15, 37, 38, 22, 219, 41, 92, 43, 44, 219, 174, 12, 54, 156, 114, 150, 176, 54, 62, 187, 161, 227, 20, 119, 58, 159, 61, 60, 90, 45, 170, 81, 152, 22, 156, 25, 195, 216, 187, 141, 190, 23, 163, 245, 146, 102, 248, 129, 53, 134, 109, 50, 192, 44, 247, 219, 122, 242, 123, 151, 38, 118, 136, 5, 82, 179, 45, 95, 252, 25, 236, 237, 34, 75, 248, 184, 90, 81, 244, 123, 142, 233, 186, 82, 152, 76, 33, 222, 144, 60, 179, 82, 104, 17, 123, 246, 177, 52, 113, 229, 255, 21, 225, 83, 40, 211, 144, 178, 165, 90, 19, 68, 213, 189, 169, 215, 238, 21, 195, 25, 240, 249, 65, 93, 120, 198, 229, 99, 57, 112, 181, 179, 107, 41, 249, 148, 213, 228, 118, 147, 251, 88, 189, 212, 210, 222, 35, 183, 156, 163, 66, 91, 142, 174, 205, 212, 34, 163, 23, 204, 4, 65, 112, 221, 160, 216, 56, 88, 242, 139, 62, 26, 167, 192, 123, 56, 90, 153, 12, 39, 241, 17, 157, 125, 147, 70, 175, 23, 255, 13, 186, 56, 168, 156, 32, 79, 87, 126, 46, 252, 243, 217, 142, 75, 6, 159, 75, 89, 245, 75, 153, 47, 194, 43, 190, 183, 129, 254, 111, 168, 213, 163, 224, 157, 54, 246, 162, 114, 129, 59, 21, 179, 243, 145, 165, 227, 23, 179, 190, 218, 29, 158, 107, 32, 226, 46, 101, 32, 69, 99, 92, 73, 28, 231, 124, 78, 170, 158, 17, 156, 254, 181, 90, 109, 148, 163, 202, 235, 213, 128, 166, 91, 25, 234, 25, 44, 182, 170, 131, 228, 214, 81, 35, 2, 56, 11, 114, 120, 25, 188, 165, 139, 115, 72, 177, 252, 107, 235, 208, 90, 138, 206, 10, 130, 114, 34, 213, 193, 1, 175, 220, 5, 17, 116, 220, 1, 145, 61, 227, 80, 149, 219, 133, 0, 153, 111, 222, 160, 189, 109, 223, 20, 61, 54, 164, 70, 148, 199, 92, 44, 11, 124, 112, 126, 115, 53, 23, 45, 245, 248, 66, 62, 53, 255, 128, 83, 52, 225, 155, 241, 244, 241, 214, 108, 222, 213, 173, 216, 220, 187, 212, 145, 199, 200, 146, 141, 129, 219, 88, 224, 65, 212, 168, 53, 19, 44, 243, 32, 37, 118, 18, 177, 93, 50, 175, 252, 126, 24, 185, 140, 80, 50, 97, 193, 196, 231, 5, 230, 197, 24, 12, 246, 29, 2, 41, 154, 20, 36, 63, 56, 121, 160, 52, 40, 23, 67, 89, 1, 88, 53, 96, 142, 145, 184, 102, 225, 247, 187, 43, 241, 23, 92, 114, 126, 3, 96, 139, 150, 229, 54, 129, 39, 16, 56, 168, 99, 208, 213, 34, 160, 87, 135, 242, 223, 124, 248, 180, 64, 27, 230, 230, 154, 108, 5, 67, 76, 58, 75, 133, 244, 110, 21, 89, 146, 121, 210, 218, 37, 82, 193, 71, 59, 85, 115, 144, 164, 225, 209, 62, 246, 93, 170, 40, 139, 167, 44, 101, 32, 119, 226, 233, 26, 158, 55, 90, 254, 253, 56, 138, 27, 199, 158, 232, 121, 91, 204, 152, 215, 246, 24, 222, 4, 217, 164, 112, 142, 58, 110, 243, 86, 140, 165, 176, 190, 76, 95, 88, 192, 244, 182, 179, 88, 139, 79, 97, 91, 90, 182, 22, 40, 167, 190, 241, 199, 248, 155, 113, 212, 17, 225, 247, 234, 240, 229, 1, 139, 106, 137, 229, 168, 67, 42, 133, 254, 22, 142, 129, 221, 239, 173, 187, 234, 7, 176, 133, 253, 218, 0, 30, 131, 142, 34, 163, 247, 213, 100, 158, 141, 164, 166, 124, 94, 195, 237, 14, 109, 171, 143, 65, 4, 143, 234, 73, 14, 163, 185, 149, 251, 4, 69, 198, 155, 221, 34, 57, 223, 20, 54, 253, 4, 66, 102, 96, 144, 108, 136, 26, 187, 7, 100, 98, 55, 73, 102, 148, 242, 0, 153, 81, 133, 94, 175, 59, 190, 252, 238, 37, 240, 30, 73, 66, 156, 178, 147, 38, 132, 194, 178, 116, 166, 46, 68, 65, 148, 248, 249, 103, 57, 223, 100, 133, 103, 94, 108, 83, 4, 251, 109, 42, 49, 127, 31, 184, 227, 228, 33, 64, 138, 126, 159, 98, 86, 203, 222, 8, 220, 91, 1, 48, 0, 193, 87, 234, 173, 194, 100, 224, 118, 73, 213, 244, 85, 154, 71, 105, 182, 171, 243, 70, 190, 7, 40, 92, 178, 203, 175, 101, 125, 164, 105, 150, 7, 127, 198, 119, 178, 133, 40, 144, 185, 212, 76, 77, 17, 33, 59, 102, 225, 250, 162, 188, 194, 22, 157, 192, 108, 50, 56, 15, 33, 15, 28, 65, 14, 237, 115, 113, 184, 10, 143, 11, 89, 231, 134, 143, 131, 86, 65, 2, 49, 54, 203, 222, 130, 32, 181, 13, 39, 128, 58, 149, 214, 113, 13, 150, 153, 133, 19, 215, 183, 234, 222, 38, 43, 237, 187, 223, 38, 90, 122, 237, 61, 29, 185, 119, 207, 226, 21, 115, 175, 23, 94, 1, 229, 121, 240, 208, 238, 133, 44, 189, 175, 89, 255, 8, 201, 68, 253, 37, 160, 75, 16, 202, 88, 181, 41, 57, 175, 21, 207, 175, 129, 114, 177, 180, 90, 214, 246, 105, 165, 20, 37, 194, 135, 212, 127, 237, 17, 198, 126, 242, 40, 205, 255, 73, 116, 32, 15, 127, 19, 196, 40, 255, 104, 225, 127, 22, 40, 207, 176, 154, 10, 208, 173, 168, 98, 140, 232, 222, 122, 224, 156, 237, 41, 23, 253, 192, 140, 209, 16, 49, 180, 235, 255, 119, 56, 251, 119, 119, 63, 238, 54, 232, 172, 33, 187, 52, 156, 69, 185, 132, 224, 14, 60, 154, 168, 190, 113, 210, 252, 14, 240, 238, 242, 134, 142, 226, 211, 210, 150, 122, 8, 180, 68, 173, 224, 98, 117, 233, 126, 43, 106, 230, 47, 86, 96, 74, 75, 88, 188, 85, 177, 148, 79, 242, 122, 104, 4, 63, 145, 122, 184, 23, 40, 246, 44, 159, 104, 20, 140, 15, 211, 197, 255, 142, 108, 69, 112, 11, 40, 47, 169, 114, 194, 70, 0, 156, 193, 104, 120, 157, 5, 253, 82, 202, 152, 24, 246, 74, 163, 68, 39, 24, 49, 252, 229, 57, 98, 34, 68, 122, 183, 98, 254, 203, 11, 155, 80, 181, 185, 160, 199, 131, 80, 78, 249, 144, 236, 92, 119, 6, 193, 65, 88, 20, 168, 163, 27, 82, 40, 217, 30, 161, 114, 125, 249, 236, 22, 119, 201, 207, 6, 18, 57, 50, 96, 219, 23, 192, 22, 208, 39, 239, 187, 8, 130, 122, 222, 115, 93, 205, 227, 156, 138, 142, 111, 247, 74, 56, 244, 81, 214, 138, 227, 24, 91, 93, 145, 68, 52, 9, 193, 61, 244, 248, 206, 85, 53, 122, 19, 111, 113, 227, 212, 104, 130, 109, 156, 72, 47, 93, 19, 8, 175, 213, 245, 134, 84, 239, 83, 223, 39, 183, 242, 221, 43, 138, 222, 57, 36, 51, 14, 151, 36, 254, 23, 61, 150, 114, 247, 151, 238, 112, 174, 139, 179, 38, 46, 31, 43, 229, 85, 79, 142, 62, 159, 213, 92, 144, 203, 157, 106, 236, 151, 93, 241, 98, 6, 240, 229, 2, 186, 57, 199, 185, 11, 76, 37, 91, 205, 113, 130, 107, 144, 211, 7, 185, 208, 247, 21, 55, 159, 22, 18, 245, 89, 182, 86, 109, 21, 141, 22, 152, 165, 116, 199, 168, 24, 64, 122, 43, 91, 63, 211, 141, 70, 145, 81, 231, 116, 151, 247, 91, 87, 214, 251, 220, 127, 215, 242, 51, 112, 138, 159, 194, 162, 139, 224, 221, 219, 27, 42, 65, 7, 117, 94, 147, 44, 39, 47, 96, 233, 235, 31, 44, 176, 93, 238, 226, 61, 110, 240, 62, 175, 19, 73, 144, 16, 229, 111, 158, 37, 105, 61, 148, 139, 132, 191, 91, 151, 189, 28, 253, 19, 156, 225, 46, 1, 195, 27, 13, 164, 80, 185, 58, 67, 186, 78, 99, 41, 51, 141, 14, 132, 73, 36, 5, 104, 69, 116, 211, 92, 219, 150, 197, 149, 38, 46, 82, 20, 179, 104, 251, 5, 135, 139, 201, 141, 165, 238, 41, 164, 56, 54, 53, 209, 163, 148, 92, 155, 89, 69, 200, 163, 124, 130, 141, 20, 195, 90, 145, 173, 44, 92, 223, 47, 118, 16, 41, 2, 159, 110, 70, 218, 72, 188, 49, 243, 182, 115, 11, 4, 163, 77, 189, 217, 164, 130, 72, 193, 52, 238, 121, 197, 62, 252, 70, 220, 107, 115, 174, 70, 191, 96, 180, 133, 15, 156, 69, 114, 233, 79, 231, 108, 141, 79, 13, 0, 216, 243, 132, 172, 46, 183, 5, 41, 103, 153, 87, 77, 162, 12, 238, 203, 141, 251, 91, 105, 98, 228, 21, 0, 34, 200, 247, 209, 102, 144, 8, 35, 214, 58, 194, 13, 29, 34, 154, 255, 225, 142, 239, 184, 180, 135, 219, 196, 93, 97, 231, 248, 19, 92, 102, 206, 19, 82, 171, 16, 23, 7, 175, 120, 21, 133, 77, 119, 57, 20, 29, 248, 65, 149, 221, 11, 23, 225, 156, 2, 207, 106, 228, 170, 182, 128, 170, 87, 100, 170, 154, 252, 33, 168, 194, 182, 220, 77, 23, 22, 86, 14, 102, 101, 150, 148, 233, 211, 206, 139, 238, 165, 218, 211, 141, 215, 253, 205, 214, 156, 228, 40, 180, 157, 129, 61, 229, 92, 110, 157, 230, 167, 225, 3, 169, 209, 9, 77, 237, 191, 194, 191, 67, 110, 181, 170, 27, 36, 178, 148, 37, 157, 177, 236, 177, 220, 82, 44, 21, 149, 134, 144, 67, 157, 29, 160, 173, 108, 94, 212, 7, 250, 187, 98, 137, 194, 129, 105, 69, 85, 100, 28, 190, 93, 106, 16, 254, 175, 88, 246, 250, 195, 51, 63, 143, 142, 193, 120, 253, 33, 85, 146, 55, 112, 35, 140, 7, 83, 230, 208, 179, 251, 78, 34, 178, 12, 79, 87, 132, 233, 245, 75, 101, 221, 80, 48, 4, 34, 113, 107, 12, 86, 122, 211, 134, 111, 0, 12, 151, 214, 94, 179, 129, 102, 23, 68, 145, 27, 75, 66, 186, 176, 216, 90, 63, 21, 159, 229, 222, 43, 25, 63, 63, 91, 22, 33, 217, 145, 181, 191, 151, 136, 173, 63, 227, 192, 234, 143, 91, 241, 253, 68, 26, 41, 107, 44, 31, 125, 244, 251, 231, 114, 198, 39, 47, 159, 199, 145, 65, 53, 12, 87, 211, 123, 107, 81, 49, 114, 115, 158, 251, 94, 146, 51, 135, 62}

// from valid msg, without checksum
var WOTSTestMsg = []byte{208, 84, 153, 96, 200, 15, 27, 122, 21, 25, 142, 166, 44, 159, 11, 126, 119, 111, 255, 15, 143, 187, 75, 0, 67, 217, 181, 197, 254, 29, 125, 215}

var WOTSSecretKey = []byte{74, 195, 60, 134, 53, 127, 2, 206, 83, 4, 21, 122, 193, 251, 158, 196, 243, 31, 146, 49, 61, 129, 152, 181, 50, 112, 254, 99, 129, 239, 108, 32, 24, 93, 207, 233, 77, 179, 152, 164, 125, 163, 37, 177, 182, 135, 105, 99, 96, 171, 67, 239, 36, 54, 191, 114, 130, 9, 37, 188, 113, 38, 126, 82, 12, 108, 147, 160, 220, 169, 95, 200, 100, 254, 168, 239, 154, 48, 224, 38, 91, 159, 175, 200, 140, 47, 13, 108, 99, 160, 117, 247, 209, 87, 28, 88, 59, 215, 78, 25, 151, 94, 203, 91, 207, 82, 38, 80, 216, 117, 131, 196, 28, 36, 177, 32, 179, 246, 17, 114, 78, 142, 132, 182, 231, 222, 184, 184, 253, 106, 84, 23, 218, 30, 14, 240, 50, 71, 68, 211, 91, 64, 202, 157, 16, 125, 15, 109, 206, 111, 134, 28, 63, 147, 141, 110, 188, 105, 218, 212, 209, 95, 26, 98, 118, 170, 123, 248, 95, 186, 238, 150, 189, 67, 232, 198, 94, 134, 98, 125, 55, 81, 196, 188, 210, 136, 30, 53, 240, 246, 39, 90, 189, 90, 133, 94, 93, 2, 174, 133, 61, 179, 1, 136, 157, 40, 87, 173, 99, 239, 139, 60, 196, 75, 44, 40, 125, 197, 142, 124, 42, 139, 120, 166, 102, 111, 115, 20, 190, 16, 216, 162, 96, 215, 90, 40, 216, 55, 49, 160, 46, 235, 3, 158, 2, 133, 25, 38, 39, 190, 148, 93, 22, 201, 86, 105, 235, 143, 83, 219, 92, 125, 89, 231, 143, 145, 178, 246, 100, 195, 18, 114, 61, 103, 0, 159, 12, 247, 232, 130, 8, 114, 141, 208, 2, 158, 67, 109, 181, 248, 23, 156, 98, 34, 205, 135, 105, 250, 35, 107, 80, 8, 151, 163, 151, 33, 25, 93, 208, 77, 132, 23, 87, 9, 57, 29, 49, 159, 49, 179, 14, 111, 213, 223, 117, 130, 167, 175, 14, 169, 183, 143, 105, 47, 157, 172, 115, 128, 233, 59, 168, 221, 58, 34, 226, 106, 161, 226, 141, 105, 119, 168, 86, 233, 210, 166, 207, 156, 199, 35, 173, 99, 58, 126, 12, 233, 237, 8, 145, 72, 76, 107, 91, 36, 175, 178, 194, 106, 130, 227, 216, 4, 166, 214, 207, 106, 88, 115, 116, 185, 57, 246, 57, 183, 219, 54, 88, 80, 0, 219, 65, 122, 120, 87, 104, 183, 130, 129, 0, 198, 132, 64, 213, 94, 233, 13, 159, 110, 203, 164, 205, 186, 242, 156, 167, 241, 92, 28, 196, 137, 104, 163, 45, 88, 54, 254, 193, 189, 242, 37, 203, 206, 211, 199, 253, 46, 251, 87, 203, 86, 124, 192, 113, 2, 170, 194, 53, 220, 75, 232, 33, 146, 172, 82, 42, 52, 185, 164, 215, 82, 74, 44, 44, 54, 5, 152, 123, 147, 249, 239, 86, 223, 40, 51, 46, 230, 10, 247, 180, 55, 179, 61, 69, 113, 34, 41, 34, 163, 62, 153, 242, 6, 86, 94, 152, 26, 116, 185, 67, 80, 68, 150, 35, 129, 180, 139, 44, 183, 146, 118, 82, 195, 101, 185, 54, 96, 187, 71, 25, 200, 209, 111, 205, 240, 26, 113, 241, 55, 198, 17, 0, 5, 116, 86, 237, 148, 8, 213, 212, 38, 10, 53, 192, 85, 121, 162, 136, 246, 185, 136, 255, 37, 45, 115, 107, 193, 151, 15, 241, 179, 253, 173, 244, 191, 54, 179, 191, 217, 164, 70, 78, 45, 223, 27, 208, 109, 68, 224, 243, 43, 92, 44, 223, 99, 84, 179, 35, 38, 149, 190, 65, 29, 174, 127, 64, 46, 21, 126, 240, 89, 122, 0, 41, 140, 228, 102, 89, 106, 119, 133, 116, 211, 208, 72, 99, 144, 57, 72, 71, 175, 20, 124, 148, 187, 4, 24, 47, 57, 7, 137, 190, 62, 185, 247, 24, 249, 88, 94, 219, 3, 184, 210, 103, 125, 135, 127, 202, 168, 169, 205, 83, 17, 89, 252, 197, 3, 9, 209, 247, 19, 210, 38, 106, 251, 14, 82, 207, 13, 57, 11, 161, 134, 187, 1, 108, 6, 143, 108, 229, 171, 77, 171, 120, 101, 162, 231, 252, 33, 149, 151, 222, 178, 152, 217, 162, 181, 168, 250, 171, 32, 174, 90, 66, 12, 9, 127, 164, 165, 251, 105, 228, 237, 237, 81, 27, 59, 228, 186, 201, 47, 196, 83, 117, 175, 255, 48, 225, 105, 3, 162, 107, 177, 239, 106, 216, 189, 100, 101, 146, 91, 155, 68, 207, 35, 168, 149, 59, 187, 168, 138, 169, 190, 3, 86, 130, 153, 67, 228, 79, 137, 212, 205, 14, 107, 68, 181, 158, 182, 68, 92, 160, 49, 220, 24, 164, 87, 194, 65, 255, 128, 81, 93, 35, 147, 229, 172, 157, 165, 46, 203, 217, 7, 22, 75, 140, 185, 57, 245, 28, 185, 46, 153, 216, 190, 214, 29, 136, 190, 17, 136, 160, 251, 94, 42, 108, 160, 92, 60, 196, 255, 100, 34, 10, 144, 38, 142, 232, 33, 252, 61, 30, 31, 176, 51, 110, 182, 227, 228, 137, 111, 174, 86, 69, 222, 155, 90, 167, 214, 9, 116, 6, 253, 139, 81, 191, 10, 224, 25, 173, 220, 243, 227, 17, 21, 195, 220, 25, 16, 103, 83, 103, 165, 194, 170, 63, 144, 218, 175, 20, 55, 164, 70, 6, 139, 232, 191, 253, 56, 138, 27, 199, 158, 232, 121, 91, 204, 152, 215, 246, 24, 222, 4, 217, 164, 112, 142, 58, 110, 243, 86, 140, 165, 176, 190, 76, 95, 88, 192, 205, 25, 49, 127, 223, 160, 79, 130, 204, 1, 67, 162, 147, 243, 136, 23, 50, 120, 193, 60, 134, 211, 37, 80, 48, 228, 201, 86, 143, 126, 44, 201, 35, 193, 118, 94, 29, 25, 188, 107, 77, 247, 131, 221, 100, 167, 61, 137, 134, 181, 188, 115, 65, 187, 32, 194, 255, 43, 150, 214, 94, 192, 64, 211, 23, 83, 107, 50, 70, 128, 154, 197, 41, 184, 177, 140, 195, 215, 214, 52, 107, 229, 67, 245, 198, 27, 210, 58, 113, 235, 19, 18, 228, 105, 11, 30, 6, 9, 206, 108, 227, 29, 132, 55, 149, 204, 166, 191, 137, 84, 156, 82, 155, 199, 181, 31, 231, 65, 91, 250, 219, 148, 46, 28, 43, 1, 69, 37, 135, 200, 16, 215, 237, 58, 191, 243, 42, 19, 171, 254, 109, 251, 114, 88, 8, 122, 94, 138, 36, 237, 39, 231, 143, 167, 129, 231, 234, 19, 32, 136, 135, 213, 49, 179, 22, 242, 22, 69, 142, 191, 121, 75, 57, 228, 48, 242, 105, 124, 1, 42, 130, 179, 214, 147, 163, 94, 179, 82, 230, 168, 187, 228, 201, 130, 90, 179, 142, 160, 217, 114, 120, 77, 98, 38, 232, 53, 147, 212, 76, 141, 211, 166, 12, 26, 69, 223, 10, 120, 39, 55, 7, 247, 16, 185, 195, 215, 75, 51, 12, 118, 137, 87, 107, 76, 233, 109, 188, 97, 203, 241, 246, 247, 35, 129, 30, 218, 217, 107, 43, 81, 139, 106, 237, 227, 65, 79, 249, 184, 101, 93, 232, 122, 133, 150, 81, 240, 222, 45, 108, 27, 235, 173, 114, 50, 181, 129, 50, 130, 86, 218, 160, 18, 149, 203, 197, 15, 118, 195, 226, 21, 115, 175, 23, 94, 1, 229, 121, 240, 208, 238, 133, 44, 189, 175, 89, 255, 8, 201, 68, 253, 37, 160, 75, 16, 202, 88, 181, 41, 57, 175, 144, 104, 212, 246, 218, 154, 139, 163, 185, 49, 202, 114, 117, 3, 46, 111, 224, 174, 77, 31, 135, 6, 123, 186, 49, 117, 194, 161, 198, 172, 45, 236, 123, 106, 6, 235, 29, 110, 252, 126, 109, 103, 113, 65, 250, 20, 71, 88, 36, 63, 196, 193, 241, 182, 251, 229, 232, 132, 3, 12, 162, 193, 30, 244, 105, 15, 245, 218, 184, 108, 153, 132, 99, 217, 43, 227, 137, 114, 202, 105, 71, 239, 82, 55, 67, 240, 108, 230, 122, 35, 175, 69, 21, 144, 237, 19, 184, 197, 26, 19, 162, 166, 6, 144, 252, 93, 8, 106, 179, 203, 168, 130, 211, 108, 146, 79, 226, 177, 169, 198, 96, 13, 99, 1, 147, 63, 231, 48, 238, 235, 145, 99, 96, 8, 115, 84, 75, 207, 241, 71, 83, 84, 223, 64, 146, 53, 116, 212, 195, 124, 160, 155, 162, 18, 84, 147, 5, 106, 41, 141, 210, 207, 253, 50, 217, 153, 143, 93, 42, 148, 82, 74, 121, 134, 245, 166, 9, 149, 165, 182, 99, 158, 214, 192, 213, 67, 35, 202, 41, 123, 0, 154, 202, 104, 240, 230, 22, 227, 113, 209, 175, 47, 235, 27, 117, 253, 19, 136, 28, 154, 87, 49, 218, 58, 39, 141, 15, 10, 65, 70, 171, 85, 209, 121, 18, 57, 50, 96, 219, 23, 192, 22, 208, 39, 239, 187, 8, 130, 122, 222, 115, 93, 205, 227, 156, 138, 142, 111, 247, 74, 56, 244, 81, 214, 138, 227, 24, 91, 93, 145, 68, 52, 9, 193, 61, 244, 248, 206, 85, 53, 122, 19, 111, 113, 227, 212, 104, 130, 109, 156, 72, 47, 93, 19, 8, 175, 213, 245, 239, 222, 192, 239, 99, 128, 186, 237, 250, 9, 167, 118, 26, 56, 38, 73, 115, 92, 91, 194, 4, 14, 11, 95, 124, 212, 17, 171, 199, 215, 248, 46, 49, 74, 180, 202, 203, 33, 22, 61, 15, 22, 36, 154, 15, 74, 178, 185, 80, 31, 250, 8, 115, 182, 181, 250, 13, 203, 232, 122, 191, 88, 24, 185, 155, 91, 104, 200, 16, 152, 54, 183, 158, 80, 124, 109, 203, 252, 192, 90, 73, 211, 227, 183, 148, 255, 134, 130, 117, 167, 38, 16, 187, 234, 157, 190, 222, 109, 108, 189, 224, 99, 194, 7, 213, 30, 58, 22, 173, 121, 176, 29, 111, 206, 152, 115, 227, 37, 208, 11, 121, 182, 84, 237, 249, 194, 253, 212, 20, 194, 58, 48, 34, 128, 117, 184, 220, 182, 48, 87, 30, 204, 159, 62, 139, 241, 245, 229, 229, 91, 155, 65, 232, 21, 69, 21, 244, 86, 113, 248, 192, 120, 176, 41, 255, 243, 152, 214, 190, 89, 157, 11, 53, 227, 70, 223, 62, 86, 192, 24, 33, 127, 206, 141, 150, 28, 228, 39, 59, 227, 203, 53, 0, 96, 137, 143, 131, 162, 105, 48, 90, 108, 160, 172, 181, 206, 15, 111, 84, 252, 83, 127, 93, 239, 59, 192, 57, 63, 8, 133, 226, 184, 82, 220, 96, 216, 102, 101, 216, 138, 12, 36, 207, 183, 93, 147, 38, 162, 149, 47, 186, 39, 168, 165, 221, 150, 4, 12, 254, 84, 24, 222, 57, 77, 97, 197, 75, 184, 245, 247, 248, 200, 92, 82, 223, 249, 67, 118, 161, 181, 130, 125, 218, 172, 155, 19, 157, 192, 34, 241, 193, 144, 202, 128, 168, 8, 34, 65, 13, 158, 66, 180, 52, 193, 22, 176, 214, 187, 3, 62, 177, 141, 104, 209, 64, 21, 28, 66, 157, 13, 127, 211, 52, 232, 61, 201, 49, 155, 122, 178, 216, 111, 0, 56, 58, 197, 188, 57, 129, 187, 190, 115, 225, 228, 62, 134, 235, 76, 137, 162, 82, 171, 228, 66, 198, 227, 176, 87, 196, 194, 48, 184, 104, 126, 239, 31, 15, 161, 29, 229, 49, 216, 139, 179, 138, 190, 165, 52, 33, 171, 199, 145, 58, 185, 166, 199, 1, 230, 117, 163, 78, 20, 82, 232, 202, 181, 97, 168, 66, 62, 108, 182, 109, 66, 10, 4, 100, 86, 220, 162, 80, 192, 113, 211, 40, 81, 76, 71, 233, 30, 167, 96, 87, 113, 123, 208, 52, 194, 177, 116, 237, 75, 53, 253, 1, 208, 218, 245, 122, 203, 220, 86, 178, 176, 10, 238, 121, 16, 203, 81, 169, 21, 27, 132, 250, 92, 187, 177, 27, 189, 116, 11, 167, 102, 48, 213, 15, 10, 108, 112, 101, 172, 14, 79, 19, 183, 72, 97, 40, 72, 153, 203, 56, 127, 162, 37, 75, 36, 34, 216, 132, 121, 33, 103, 155, 62, 96, 115, 90, 205, 159, 141, 54, 238, 131, 92, 247, 107, 34, 238, 92, 100, 183, 163, 89, 215, 207, 80, 40, 113, 60, 160, 65, 136, 204, 38, 60, 147, 0, 168, 95, 192, 130, 247, 225, 5, 243, 3, 132, 32, 133, 246, 12, 124, 35, 175, 107, 129, 204, 191, 83, 116, 137, 210, 100, 136, 35, 57, 4, 47, 34, 172, 226, 52, 88, 63, 125, 77, 135, 113, 223, 129, 8, 9, 163, 101, 84, 118, 140, 136, 188, 155, 15, 163, 235, 98, 181, 146, 187, 226, 140, 43, 253, 119, 130, 47, 146, 53, 255, 180, 109, 206, 74, 76, 135, 131, 191, 108, 26, 72, 109, 52, 125, 91, 183, 48, 255, 203}

func TestMessageRetrieval(t *testing.T) {
	params := parameters.MakeSphincsPlusSHA256256fRobust(false)
	_, pk := sphincs.Spx_keygen(params)

	message := getWOTSMessageFromSignatureAndPK(WOTSTestSig, WOTSPublicKey, params, pk.PKseed)

	if !slices.Equal(util.Base_w(WOTSTestMsg, params.W, params.Len1), message[:params.Len1]) {
		t.Error("Retrieved message should be the test message")
	}
}

// wots secret key shouldn't be known by an attacker. This is just to check I have the correct pair
func TestWOTSKeyPair(t *testing.T) {
	params := parameters.MakeSphincsPlusSHA256256fRobust(false)
	_, pk := sphincs.Spx_keygen(params)

	adrs := new(address.ADRS)
	adrs.SetLayerAddress(16) // target layer in the tree

	for i := 0; i < params.Len; i++ {
		adrs.SetChainAddress(i)
		hashed := wots.Chain(params, WOTSSecretKey[i*params.N:(i+1)*params.N], 0, 15, pk.PKseed, adrs)
		if !bytes.Equal(hashed, WOTSPublicKey[i*params.N:(i+1)*params.N]) {
			t.Fatal("Secret key and Public key don't seem to match")
		}
	}
}

func TestPKFromSigAndMsg(t *testing.T) {
	params := parameters.MakeSphincsPlusSHA256256fRobust(false)
	_, pk := sphincs.Spx_keygen(params)

	wots_pk := getWOTSPKFromMessageAndSignature(params, WOTSTestSig, WOTSTestMsg, pk.PKseed)

	if !bytes.Equal(wots_pk, WOTSPublicKey) {
		t.Error("Expected public keys to be the same")
	}

	//adrs := new(address.ADRS)
	//adrs.SetLayerAddress(16) // target layer in the tree
	//wotspkADRS := adrs.Copy()
	//wotspkADRS.SetType(address.WOTS_PK)
	//wotspkADRS.SetKeyPairAddress(adrs.GetKeyPairAddress())
	//
	//pk_sig := params.Tweak.T_l(pk.PKseed, wotspkADRS, wots_pk)
	//fmt.Println(pk_sig)
}
